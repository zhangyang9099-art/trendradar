
    <!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>热点新闻分析</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" integrity="sha512-BNaRQnYJYiPSqHHDb58B0yaPfCu+Wgds8Gp/gU33kqBtgNS4tSPHuGibyoeqMV/TJlSKda6FXzoEyYGjTe+vXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <style>
            * { box-sizing: border-box; }
            body { 
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
                margin: 0; 
                padding: 16px; 
                background: #fafafa;
                color: #333;
                line-height: 1.5;
            }
            
            .container {
                max-width: 600px;
                margin: 0 auto;
                background: white;
                border-radius: 12px;
                overflow: hidden;
                box-shadow: 0 2px 16px rgba(0,0,0,0.06);
            }
            
            .header {
                background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
                color: white;
                padding: 32px 24px;
                text-align: center;
                position: relative;
            }
            
            .save-buttons {
                position: absolute;
                top: 16px;
                right: 16px;
                display: flex;
                gap: 8px;
            }
            
            .save-btn {
                background: rgba(255, 255, 255, 0.2);
                border: 1px solid rgba(255, 255, 255, 0.3);
                color: white;
                padding: 8px 16px;
                border-radius: 6px;
                cursor: pointer;
                font-size: 13px;
                font-weight: 500;
                transition: all 0.2s ease;
                backdrop-filter: blur(10px);
                white-space: nowrap;
            }
            
            .save-btn:hover {
                background: rgba(255, 255, 255, 0.3);
                border-color: rgba(255, 255, 255, 0.5);
                transform: translateY(-1px);
            }
            
            .save-btn:active {
                transform: translateY(0);
            }
            
            .save-btn:disabled {
                opacity: 0.6;
                cursor: not-allowed;
            }
            
            .header-title {
                font-size: 22px;
                font-weight: 700;
                margin: 0 0 20px 0;
            }
            
            .header-info {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 16px;
                font-size: 14px;
                opacity: 0.95;
            }
            
            .info-item {
                text-align: center;
            }
            
            .info-label {
                display: block;
                font-size: 12px;
                opacity: 0.8;
                margin-bottom: 4px;
            }
            
            .info-value {
                font-weight: 600;
                font-size: 16px;
            }
            
            .content {
                padding: 24px;
            }
            
            .word-group {
                margin-bottom: 40px;
            }
            
            .word-group:first-child {
                margin-top: 0;
            }
            
            .word-header {
                display: flex;
                align-items: center;
                justify-content: space-between;
                margin-bottom: 20px;
                padding-bottom: 8px;
                border-bottom: 1px solid #f0f0f0;
            }
            
            .word-info {
                display: flex;
                align-items: center;
                gap: 12px;
            }
            
            .word-name {
                font-size: 17px;
                font-weight: 600;
                color: #1a1a1a;
            }
            
            .word-count {
                color: #666;
                font-size: 13px;
                font-weight: 500;
            }
            
            .word-count.hot { color: #dc2626; font-weight: 600; }
            .word-count.warm { color: #ea580c; font-weight: 600; }
            
            .word-index {
                color: #999;
                font-size: 12px;
            }
            
            .news-item {
                margin-bottom: 20px;
                padding: 16px 0;
                border-bottom: 1px solid #f5f5f5;
                position: relative;
                display: flex;
                gap: 12px;
                align-items: center;
            }
            
            .news-item:last-child {
                border-bottom: none;
            }
            
            .news-item.new::after {
                content: "NEW";
                position: absolute;
                top: 12px;
                right: 0;
                background: #fbbf24;
                color: #92400e;
                font-size: 9px;
                font-weight: 700;
                padding: 3px 6px;
                border-radius: 4px;
                letter-spacing: 0.5px;
            }
            
            .news-number {
                color: #999;
                font-size: 13px;
                font-weight: 600;
                min-width: 20px;
                text-align: center;
                flex-shrink: 0;
                background: #f8f9fa;
                border-radius: 50%;
                width: 24px;
                height: 24px;
                display: flex;
                align-items: center;
                justify-content: center;
                align-self: flex-start;
                margin-top: 8px;
            }
            
            .news-content {
                flex: 1;
                min-width: 0;
                padding-right: 40px;
            }
            
            .news-item.new .news-content {
                padding-right: 50px;
            }
            
            .news-header {
                display: flex;
                align-items: center;
                gap: 8px;
                margin-bottom: 8px;
                flex-wrap: wrap;
            }
            
            .source-name {
                color: #666;
                font-size: 12px;
                font-weight: 500;
            }
            
            .rank-num {
                color: #fff;
                background: #6b7280;
                font-size: 10px;
                font-weight: 700;
                padding: 2px 6px;
                border-radius: 10px;
                min-width: 18px;
                text-align: center;
            }
            
            .rank-num.top { background: #dc2626; }
            .rank-num.high { background: #ea580c; }
            
            .time-info {
                color: #999;
                font-size: 11px;
            }
            
            .count-info {
                color: #059669;
                font-size: 11px;
                font-weight: 500;
            }
            
            .news-title {
                font-size: 15px;
                line-height: 1.4;
                color: #1a1a1a;
                margin: 0;
            }
            
            .news-link {
                color: #2563eb;
                text-decoration: none;
            }
            
            .news-link:hover {
                text-decoration: underline;
            }
            
            .news-link:visited {
                color: #7c3aed;
            }
            
            .new-section {
                margin-top: 40px;
                padding-top: 24px;
                border-top: 2px solid #f0f0f0;
            }
            
            .new-section-title {
                color: #1a1a1a;
                font-size: 16px;
                font-weight: 600;
                margin: 0 0 20px 0;
            }
            
            .new-source-group {
                margin-bottom: 24px;
            }
            
            .new-source-title {
                color: #666;
                font-size: 13px;
                font-weight: 500;
                margin: 0 0 12px 0;
                padding-bottom: 6px;
                border-bottom: 1px solid #f5f5f5;
            }
            
            .new-item {
                display: flex;
                align-items: center;
                gap: 12px;
                padding: 8px 0;
                border-bottom: 1px solid #f9f9f9;
            }
            
            .new-item:last-child {
                border-bottom: none;
            }
            
            .new-item-number {
                color: #999;
                font-size: 12px;
                font-weight: 600;
                min-width: 18px;
                text-align: center;
                flex-shrink: 0;
                background: #f8f9fa;
                border-radius: 50%;
                width: 20px;
                height: 20px;
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            .new-item-rank {
                color: #fff;
                background: #6b7280;
                font-size: 10px;
                font-weight: 700;
                padding: 3px 6px;
                border-radius: 8px;
                min-width: 20px;
                text-align: center;
                flex-shrink: 0;
            }
            
            .new-item-rank.top { background: #dc2626; }
            .new-item-rank.high { background: #ea580c; }
            
            .new-item-content {
                flex: 1;
                min-width: 0;
            }
            
            .new-item-title {
                font-size: 14px;
                line-height: 1.4;
                color: #1a1a1a;
                margin: 0;
            }
            
            .error-section {
                background: #fef2f2;
                border: 1px solid #fecaca;
                border-radius: 8px;
                padding: 16px;
                margin-bottom: 24px;
            }
            
            .error-title {
                color: #dc2626;
                font-size: 14px;
                font-weight: 600;
                margin: 0 0 8px 0;
            }
            
            .error-list {
                list-style: none;
                padding: 0;
                margin: 0;
            }
            
            .error-item {
                color: #991b1b;
                font-size: 13px;
                padding: 2px 0;
                font-family: 'SF Mono', Consolas, monospace;
            }
            
            .footer {
                margin-top: 32px;
                padding: 20px 24px;
                background: #f8f9fa;
                border-top: 1px solid #e5e7eb;
                text-align: center;
            }
            
            .footer-content {
                font-size: 13px;
                color: #6b7280;
                line-height: 1.6;
            }
            
            .footer-link {
                color: #4f46e5;
                text-decoration: none;
                font-weight: 500;
                transition: color 0.2s ease;
            }
            
            .footer-link:hover {
                color: #7c3aed;
                text-decoration: underline;
            }
            
            .project-name {
                font-weight: 600;
                color: #374151;
            }
            
            @media (max-width: 480px) {
                body { padding: 12px; }
                .header { padding: 24px 20px; }
                .content { padding: 20px; }
                .footer { padding: 16px 20px; }
                .header-info { grid-template-columns: 1fr; gap: 12px; }
                .news-header { gap: 6px; }
                .news-content { padding-right: 45px; }
                .news-item { gap: 8px; }
                .new-item { gap: 8px; }
                .news-number { width: 20px; height: 20px; font-size: 12px; }
                .save-buttons {
                    position: static;
                    margin-bottom: 16px;
                    display: flex;
                    gap: 8px;
                    justify-content: center;
                    flex-direction: column;
                    width: 100%;
                }
                .save-btn {
                    width: 100%;
                }
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="header">
                <div class="save-buttons">
                    <button class="save-btn" onclick="saveAsImage()">保存为图片</button>
                    <button class="save-btn" onclick="saveAsMultipleImages()">分段保存</button>
                </div>
                <div class="header-title">热点新闻分析</div>
                <div class="header-info">
                    <div class="info-item">
                        <span class="info-label">报告类型</span>
                        <span class="info-value">当日汇总</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">新闻总数</span>
                        <span class="info-value">1140 条</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">热点新闻</span>
                        <span class="info-value">53 条</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">生成时间</span>
                        <span class="info-value">01-17 23:24</span>
                    </div>
                </div>
            </div>
            
            <div class="content">
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name"># 军工 / 航天 / 卫星 军工 国防军工 军费 军品订单 导弹 防空 雷达 无人机 察打一体 火箭 航天发射 卫星 卫星互联网 低轨卫星 星座组网 北斗 军工配套 军工供应链</div>
                            <div class="word-count hot">17 条</div>
                        </div>
                        <div class="word-index">1/9</div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社热门</span><span class="rank-num ">7-13</span><span class="time-info">09时56分~23时24分</span><span class="count-info">14次</span>
                            </div>
                            <div class="news-title"><a href="https://www.cls.cn/detail/2260213" target="_blank" class="news-link">商业火箭发射密度不断加大 可复用技术成降本关键 各环节价值量几何？</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">bilibili 热搜</span><span class="rank-num ">8-30</span><span class="time-info">11时27分~23时24分</span><span class="count-info">13次</span>
                            </div>
                            <div class="news-title"><a href="https://search.bilibili.com/all?keyword=%E5%AE%9E%E8%B7%B5%E4%B8%89%E5%8D%81%E4%BA%8C%E5%8F%B7%E5%8D%AB%E6%98%9F%E5%8F%91%E5%B0%84%E5%A4%B1%E5%88%A9" target="_blank" class="news-link">实践三十二号卫星发射失利</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">3</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">抖音</span><span class="rank-num top">2-11</span><span class="time-info">11时27分~18时24分</span><span class="count-info">8次</span>
                            </div>
                            <div class="news-title"><a href="https://www.douyin.com/hot/2370444" target="_blank" class="news-link">实践三十二号卫星发射失利</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">4</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">bilibili 热搜</span><span class="rank-num high">4-29</span><span class="time-info">00时34分~07时24分</span><span class="count-info">8次</span>
                            </div>
                            <div class="news-title"><a href="https://search.bilibili.com/all?keyword=%E9%9B%B7%E9%9C%86%E5%A4%A7%E8%83%9C%E7%81%AB%E7%AE%AD" target="_blank" class="news-link">雷霆大胜火箭</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">5</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社热门</span><span class="rank-num ">9-11</span><span class="time-info">00时34分~07时24分</span><span class="count-info">8次</span>
                            </div>
                            <div class="news-title"><a href="https://www.cls.cn/detail/2260526" target="_blank" class="news-link">新一代四米级可重复使用火箭长征十二号乙运载火箭静态点火试验圆满成功</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">6</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">百度热搜</span><span class="rank-num top">1-23</span><span class="time-info">11时27分~16时31分</span><span class="count-info">6次</span>
                            </div>
                            <div class="news-title"><a href="https://www.baidu.com/s?wd=%E5%AE%9E%E8%B7%B5%E4%B8%89%E5%8D%81%E4%BA%8C%E5%8F%B7%E5%8D%AB%E6%98%9F%E5%8F%91%E5%B0%84%E5%A4%B1%E5%88%A9" target="_blank" class="news-link">实践三十二号卫星发射失利</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">7</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻</span><span class="rank-num ">6-9</span><span class="time-info">17时25分~23时24分</span><span class="count-info">7次</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/articles/3763518" target="_blank" class="news-link">两型运载火箭发射失利：长征三号乙与谷神星二号任务未获成功</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">8</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">7-29</span><span class="time-info">11时27分~17时25分</span><span class="count-info">7次</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7596150594784464390/" target="_blank" class="news-link">实践三十二号卫星发射失利</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">9</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">抖音</span><span class="rank-num ">8-15</span><span class="time-info">18时24分~23时24分</span><span class="count-info">6次</span>
                            </div>
                            <div class="news-title"><a href="https://www.douyin.com/hot/2371006" target="_blank" class="news-link">解放军无人机位我东沙岛附近训练</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">10</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">知乎</span><span class="rank-num top">2</span><span class="time-info">19时20分</span>
                            </div>
                            <div class="news-title"><a href="https://www.zhihu.com/question/1995867070047412864" target="_blank" class="news-link">谷神星二号民营商业运载火箭首次飞行试验任务失利，原因可能是什么？一次发射失利对民营火箭企业影响有多大？</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">11</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">24-27</span><span class="time-info">16时31分~18时24分</span><span class="count-info">3次</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7595634973274128425/" target="_blank" class="news-link">2026年民营商业航天火箭发射首战告捷</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">12</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">19-22</span><span class="time-info">18时24分~19时20分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7595710952167768106/" target="_blank" class="news-link">谷神星二号运载火箭首飞失利</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">13</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">6</span><span class="time-info">02时38分</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7595505820075753526/" target="_blank" class="news-link">深圳百架无人机严查电动自行车违法</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">14</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">12</span><span class="time-info">19时20分</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7596149532405284915/" target="_blank" class="news-link">今日两发火箭任务失利</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">15</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">微博</span><span class="rank-num ">17</span><span class="time-info">11时27分</span>
                            </div>
                            <div class="news-title"><a href="https://s.weibo.com/weibo?q=%23%E5%AE%9E%E8%B7%B5%E4%B8%89%E5%8D%81%E4%BA%8C%E5%8F%B7%E5%8D%AB%E6%98%9F%E5%8F%91%E5%B0%84%E5%A4%B1%E5%88%A9%23&amp;t=31&amp;band_rank=17&amp;Refer=top" target="_blank" class="news-link">实践三十二号卫星发射失利</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">16</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">23</span><span class="time-info">11时27分</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7595744416854392870/" target="_blank" class="news-link">泽连斯基：乌防空导弹库存告急</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">17</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">26</span><span class="time-info">21时31分</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7596212180794478090/" target="_blank" class="news-link">外媒：美军押注新武器对抗中国导弹</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name"># AI / 大模型 / 算力 AI 人工智能 大模型 生成式AI 算力 算力中心 GPU NPU AI芯片 通用芯片 推理芯片 训练芯片 英伟达 英伟达芯片 华为昇腾 昇腾 智算中心 算力网络</div>
                            <div class="word-count hot">11 条</div>
                        </div>
                        <div class="word-index">2/9</div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻</span><span class="rank-num top">3-7</span><span class="time-info">00时34分~13时24分</span><span class="count-info">12次</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/articles/3763449" target="_blank" class="news-link">特朗普拟紧急干预电力市场：强压AI巨头签15年长约，为150亿美元新电厂买单</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">bilibili 热搜</span><span class="rank-num top">1-10</span><span class="time-info">00时34分~09时56分</span><span class="count-info">9次</span>
                            </div>
                            <div class="news-title"><a href="https://search.bilibili.com/all?keyword=%E7%AE%97%E5%8A%9B%E7%9C%9F%E7%9A%84%E8%83%BD%E6%97%A0%E9%99%90%E5%A2%9E%E9%95%BF%E5%90%97" target="_blank" class="news-link">算力真的能无限增长吗</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">3</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻</span><span class="rank-num ">7-10</span><span class="time-info">09时56分~19时20分</span><span class="count-info">10次</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/articles/3763470" target="_blank" class="news-link">胜宏科技2025年业绩预增260.35%-295.00%，AI算力需求推动PCB业务爆发 | 财报见闻</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">4</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻</span><span class="rank-num ">6-10</span><span class="time-info">00时34分~09时56分</span><span class="count-info">9次</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/articles/3763432" target="_blank" class="news-link">老黄“领先一步”，当所有人都在争夺台积电产能，英伟达在“抢地”</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">5</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">bilibili 热搜</span><span class="rank-num ">6-7</span><span class="time-info">00时34分~07时24分</span><span class="count-info">8次</span>
                            </div>
                            <div class="news-title"><a href="https://search.bilibili.com/all?keyword=%E6%B8%85%E5%8D%8E%E5%A7%9A%E7%8F%AD%E9%99%88%E7%AB%8B%E6%9D%B0%E5%8A%A0%E5%85%A5OpenAI" target="_blank" class="news-link">清华姚班陈立杰加入OpenAI</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">6</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社热门</span><span class="rank-num ">6-7</span><span class="time-info">00时34分~07时24分</span><span class="count-info">8次</span>
                            </div>
                            <div class="news-title"><a href="https://www.cls.cn/detail/2260421" target="_blank" class="news-link">【焦点复盘】沪指日线4连跌失守10日线，AI软硬件分化加剧，机器人概念持续活跃</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">7</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社热门</span><span class="rank-num ">7-8</span><span class="time-info">00时34分~05时25分</span><span class="count-info">6次</span>
                            </div>
                            <div class="news-title"><a href="https://www.cls.cn/detail/2260348" target="_blank" class="news-link">【每日收评】沪指小幅收跌险守4100点，半导体产业链逆势走强，AI应用持续调整</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">8</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">bilibili 热搜</span><span class="rank-num top">3</span><span class="time-info">11时27分</span>
                            </div>
                            <div class="news-title"><a href="https://search.bilibili.com/all?keyword=%E8%8B%B1%E4%BC%9F%E8%BE%BE%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83%E9%93%9C%E7%94%A8%E9%87%8F%E8%A1%A8%E8%BF%B0" target="_blank" class="news-link">英伟达修改数据中心铜用量表述</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">9</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻</span><span class="rank-num ">8-9</span><span class="time-info">20时48分~23时24分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/articles/3763511" target="_blank" class="news-link">“HBM之父”：高带宽闪存（HBF）商业化进程超预期，或将在2-3年内集成到GPU，市场规模将超HBM</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">10</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻</span><span class="rank-num ">10</span><span class="time-info">18时24分</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/articles/3763484" target="_blank" class="news-link">Anthropic刚发布了一份「AI抢饭碗报告」：学历越高越「被抢」</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">11</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">29</span><span class="time-info">21时31分</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7596273644796382730/" target="_blank" class="news-link">Nature警告：AI让科学的路反而更窄了</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name"># 新能源车 / 电池 / 锂矿 新能源车 电动车 新能源汽车 整车销量 交付数据 交付量 动力电池 车载电池 电池订单 固态电池 钠离子电池 磷酸铁锂 三元电池 快充 超充 一体化压铸 智能座舱 锂矿 锂价 碳酸锂 锂精矿 锂资源 矿山项目</div>
                            <div class="word-count warm">8 条</div>
                        </div>
                        <div class="word-index">3/9</div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">澎湃新闻</span><span class="rank-num top">1-3</span><span class="time-info">00时34分~09时56分</span><span class="count-info">9次</span>
                            </div>
                            <div class="news-title"><a href="https://m.thepaper.cn/newsDetail_forward_32398029" target="_blank" class="news-link">通过数字身份证溯源，新能源车废旧动力电池回收利用新规发布</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">知乎</span><span class="rank-num ">6</span><span class="time-info">09时56分~23时24分</span><span class="count-info">14次</span>
                            </div>
                            <div class="news-title"><a href="https://www.zhihu.com/question/1995590791582749441" target="_blank" class="news-link">加拿大总理卡尼宣布取消对华电车 100% 加税，将以优惠关税进口 4.9 万辆电动车，有何影响？</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">3</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">百度热搜</span><span class="rank-num top">3</span><span class="time-info">16时31分~20时48分</span><span class="count-info">5次</span>
                            </div>
                            <div class="news-title"><a href="https://www.baidu.com/s?wd=%E5%8A%A8%E5%8A%9B%E7%94%B5%E6%B1%A0%E5%9B%9E%E6%94%B6%E6%96%B0%E8%A7%84%E6%9D%A5%E4%BA%86" target="_blank" class="news-link">动力电池回收新规来了</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">4</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">微博</span><span class="rank-num ">16-26</span><span class="time-info">00时34分~05时25分</span><span class="count-info">6次</span>
                            </div>
                            <div class="news-title"><a href="https://s.weibo.com/weibo?q=%23%E6%A1%83%E9%BB%91%E9%BB%91%E6%94%B6%E5%88%B0%E4%BA%86%E6%9C%89%E5%8F%B2%E4%BB%A5%E6%9D%A5%E6%9C%80%E7%A6%BB%E8%B0%B1%E7%9A%84%E7%94%B5%E5%8A%A8%E8%BD%A6%23&amp;t=31&amp;band_rank=26&amp;Refer=top" target="_blank" class="news-link">桃黑黑收到了有史以来最离谱的电动车</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">5</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">10-28</span><span class="time-info">11时27分~15时23分</span><span class="count-info">5次</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7595848870715883558/" target="_blank" class="news-link">电动车都出来上班了</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">6</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">知乎</span><span class="rank-num ">10-13</span><span class="time-info">20时48分~23时24分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://www.zhihu.com/question/1995807702694269078" target="_blank" class="news-link">全球首个电动车电耗强制新国标实施，媒体称部分电车重达 3 吨，新能源车该减肥了，行业会否转向能效技术竞赛？</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">7</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">17-29</span><span class="time-info">22时23分~23时24分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7596288943369227818/" target="_blank" class="news-link">报废新能源车为何必须“车电一体”</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">8</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">24</span><span class="time-info">18时24分</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7596236229813734931/" target="_blank" class="news-link">欧盟会提高中国混动新能源车关税吗</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name"># 半导体 / 存储 / EDA 半导体 集成电路 存储芯片 存储器 DDR5 高带宽内存 HBM 封测 封装测试 光刻 光刻机 晶圆 晶圆厂 晶圆代工 代工厂 先进制程 制程升级 EDA 设计工具</div>
                            <div class="word-count warm">5 条</div>
                        </div>
                        <div class="word-index">4/9</div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社热门</span><span class="rank-num top">2-7</span><span class="time-info">11时27分~23时24分</span><span class="count-info">13次</span>
                            </div>
                            <div class="news-title"><a href="https://www.cls.cn/detail/2261067" target="_blank" class="news-link">性能突破性提升！我国攻克半导体材料世界难题</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">百度热搜</span><span class="rank-num high">4</span><span class="time-info">00时34分~07时24分</span><span class="count-info">8次</span>
                            </div>
                            <div class="news-title"><a href="https://www.baidu.com/s?wd=%E4%B8%AD%E5%9B%BD%E6%94%BB%E5%85%8B%E5%8D%8A%E5%AF%BC%E4%BD%93%E6%9D%90%E6%96%99%E4%B8%96%E7%95%8C%E9%9A%BE%E9%A2%98" target="_blank" class="news-link">中国攻克半导体材料世界难题</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">3</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻</span><span class="rank-num high">5-8</span><span class="time-info">00时34分~16时31分</span><span class="count-info">15次</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/articles/3763433" target="_blank" class="news-link">沪指险守4100点，两市ETF成交再创历史天量，电网设备走强，半导体产业链爆发，碳酸锂跌停</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">4</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社热门</span><span class="rank-num ">7-10</span><span class="time-info">18时24分~23时24分</span><span class="count-info">6次</span>
                            </div>
                            <div class="news-title"><a href="https://www.cls.cn/detail/2261163" target="_blank" class="news-link">半导体封测概念股两日累计涨超30% 本周披露并购重组进展的A股名单一览</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">5</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">13-25</span><span class="time-info">16时31分~22时23分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7595717085641539620/" target="_blank" class="news-link">中国攻克半导体材料世界难题</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name"># 宏观政策 / 产业规划（容易触发产业轮动） 产业政策 扶持政策 补贴 税收优惠 新政 重磅新政 征求意见 征求意见稿 指导意见 实施方案 行动方案 专项规划 发展规划 十四五规划 产业升级 产能置换 能耗双控 以旧换新 消费刺激 扩内需 稳增长</div>
                            <div class="word-count ">4 条</div>
                        </div>
                        <div class="word-index">5/9</div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">凤凰网</span><span class="rank-num high">5-8</span><span class="time-info">11时27分~22时23分</span><span class="count-info">12次</span>
                            </div>
                            <div class="news-title"><a href="https://news.ifeng.com/c/8pz2QNtwV6g" target="_blank" class="news-link">伊朗政府向市民发放“电子补贴券”，凤凰记者走访德黑兰连锁超市</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">6</span><span class="time-info">09时56分~22时23分</span><span class="count-info">13次</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7596136547364310555/" target="_blank" class="news-link">网警发布领取育儿补贴硬核攻略</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">3</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">百度热搜</span><span class="rank-num ">6</span><span class="time-info">09时56分~22时23分</span><span class="count-info">13次</span>
                            </div>
                            <div class="news-title"><a href="https://www.baidu.com/s?wd=%E7%BD%91%E8%AD%A6%E5%AE%88%E6%8A%A4%E5%85%BB%E5%A8%83%E9%92%B1%EF%BC%9A%E9%A2%86%E8%82%B2%E5%84%BF%E8%A1%A5%E8%B4%B4%E7%A1%AC%E6%A0%B8%E6%94%BB%E7%95%A5" target="_blank" class="news-link">网警守护养娃钱：领育儿补贴硬核攻略</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">4</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">bilibili 热搜</span><span class="rank-num ">6</span><span class="time-info">11时27分~22时23分</span><span class="count-info">12次</span>
                            </div>
                            <div class="news-title"><a href="https://search.bilibili.com/all?keyword=%E7%BD%91%E8%AD%A6%E5%8F%91%E5%B8%83%E9%A2%86%E5%8F%96%E8%82%B2%E5%84%BF%E8%A1%A5%E8%B4%B4%E7%A1%AC%E6%A0%B8%E6%94%BB%E7%95%A5" target="_blank" class="news-link">网警发布领取育儿补贴硬核攻略</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name"># 消费电子 / 智能硬件 消费电子 智能手机 高端手机 可穿戴 智能手表 手环 TWS 蓝牙耳机 AR VR XR MR 空间计算 苹果产业链 果链 安卓阵营 折叠屏 影像系统 影像升级 车载电子 车载显示 车载娱乐</div>
                            <div class="word-count ">3 条</div>
                        </div>
                        <div class="word-index">6/9</div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">知乎</span><span class="rank-num top">3-13</span><span class="time-info">09时56分~15时23分</span><span class="count-info">6次</span>
                            </div>
                            <div class="news-title"><a href="https://www.zhihu.com/question/1994794243710005384" target="_blank" class="news-link">如何看待 IDC 公布 2025 年中国智能手机市场出货量，华为、苹果、 vivo 位列前三？</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">bilibili 热搜</span><span class="rank-num top">1-11</span><span class="time-info">14时36分~16时31分</span><span class="count-info">3次</span>
                            </div>
                            <div class="news-title"><a href="https://search.bilibili.com/all?keyword=KPL" target="_blank" class="news-link">DRG vs eStarPro KPL春季赛</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">3</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">微博</span><span class="rank-num ">13-28</span><span class="time-info">09时56分~13时24分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://s.weibo.com/weibo?q=%23%E4%B8%BA%E4%BB%80%E4%B9%88%E6%88%B4%E4%BA%86%E6%99%BA%E8%83%BD%E6%89%8B%E8%A1%A8%E5%8F%8D%E8%80%8C%E7%9D%A1%E4%B8%8D%E5%A5%BD%23&amp;t=31&amp;band_rank=13&amp;Refer=top" target="_blank" class="news-link">为什么戴了智能手表反而睡不好</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name"># 机器人 / 自动驾驶 / 传感器 机器人 工业机器人 协作机器人 人形机器人 人形机器 机器人订单 自动驾驶 智能驾驶 高阶智驾 辅助驾驶 NOA 城市NOA 激光雷达 毫米波雷达 摄像头模组 传感器 底盘域控制 智驾芯片 车规芯片</div>
                            <div class="word-count ">2 条</div>
                        </div>
                        <div class="word-index">7/9</div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">澎湃新闻</span><span class="rank-num ">19-20</span><span class="time-info">20时48分~23时24分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://m.thepaper.cn/newsDetail_forward_32406619" target="_blank" class="news-link">新城市志｜剑指高级别自动驾驶引领区，上海底气何来</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">10-16</span><span class="time-info">14时36分~16时31分</span><span class="count-info">3次</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7595952035905142847/" target="_blank" class="news-link">你期待机器人进入家庭陪伴老人吗</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name"># 订单 / 产能 / 周期信号（跨行业强化词） 订单 大单 新增订单 批量订单 集中采购 招标 中标 中标公告 长单 锁单 签约 签大单 扩产 扩产能 投产 试生产 达产 满产 排产 放量 放量增长 量产 量产爬坡 涨价 提价 提产 涨幅明显 去库存 补库存 景气度 景气回升 周期反转 周期回暖 超预期 高景气 高增长</div>
                            <div class="word-count ">2 条</div>
                        </div>
                        <div class="word-index">8/9</div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">7-25</span><span class="time-info">01时27分~03时22分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7594815915368579091/" target="_blank" class="news-link">内存价格暴涨电脑组装涨价一至两千元</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">28-30</span><span class="time-info">12时35分~13时24分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7596146561399131694/" target="_blank" class="news-link">内存条全线涨价 中国企业准备好了吗</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name"># 光伏 / 风电 / 储能 光伏 光伏组件 组件订单 装机量 装机数据 N型电池 TOPCon HJT 逆变器 电站项目 集中式电站 分布式光伏 储能 工商业储能 家庭储能 集中式储能 共享储能 风电 海上风电 风机订单 光储一体 源网荷储</div>
                            <div class="word-count ">1 条</div>
                        </div>
                        <div class="word-index">9/9</div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻</span><span class="rank-num ">9</span><span class="time-info">09时56分~13时24分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/articles/3763442" target="_blank" class="news-link">白银暴涨，光伏流泪</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="footer">
                <div class="footer-content">
                    由 <span class="project-name">TrendRadar</span> 生成 · 
                    <a href="https://github.com/sansan0/TrendRadar" target="_blank" class="footer-link">
                        GitHub 开源项目
                    </a>
                    <br>
                    <span style="color: #ea580c; font-weight: 500;">
                        发现新版本 5.2.0，当前版本 3.0.5
                    </span>
                </div>
            </div>
        </div>
        
        <script>
            async function saveAsImage() {
                const button = event.target;
                const originalText = button.textContent;
                
                try {
                    button.textContent = '生成中...';
                    button.disabled = true;
                    window.scrollTo(0, 0);
                    
                    // 等待页面稳定
                    await new Promise(resolve => setTimeout(resolve, 200));
                    
                    // 截图前隐藏按钮
                    const buttons = document.querySelector('.save-buttons');
                    buttons.style.visibility = 'hidden';
                    
                    // 再次等待确保按钮完全隐藏
                    await new Promise(resolve => setTimeout(resolve, 100));
                    
                    const container = document.querySelector('.container');
                    
                    const canvas = await html2canvas(container, {
                        backgroundColor: '#ffffff',
                        scale: 1.5,
                        useCORS: true,
                        allowTaint: false,
                        imageTimeout: 10000,
                        removeContainer: false,
                        foreignObjectRendering: false,
                        logging: false,
                        width: container.offsetWidth,
                        height: container.offsetHeight,
                        x: 0,
                        y: 0,
                        scrollX: 0,
                        scrollY: 0,
                        windowWidth: window.innerWidth,
                        windowHeight: window.innerHeight
                    });
                    
                    buttons.style.visibility = 'visible';
                    
                    const link = document.createElement('a');
                    const now = new Date();
                    const filename = `TrendRadar_热点新闻分析_${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}${String(now.getDate()).padStart(2, '0')}_${String(now.getHours()).padStart(2, '0')}${String(now.getMinutes()).padStart(2, '0')}.png`;
                    
                    link.download = filename;
                    link.href = canvas.toDataURL('image/png', 1.0);
                    
                    // 触发下载
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    button.textContent = '保存成功!';
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.disabled = false;
                    }, 2000);
                    
                } catch (error) {
                    const buttons = document.querySelector('.save-buttons');
                    buttons.style.visibility = 'visible';
                    button.textContent = '保存失败';
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.disabled = false;
                    }, 2000);
                }
            }
            
            async function saveAsMultipleImages() {
                const button = event.target;
                const originalText = button.textContent;
                const container = document.querySelector('.container');
                const scale = 1.5; 
                const maxHeight = 5000 / scale;
                
                try {
                    button.textContent = '分析中...';
                    button.disabled = true;
                    
                    // 获取所有可能的分割元素
                    const newsItems = Array.from(container.querySelectorAll('.news-item'));
                    const wordGroups = Array.from(container.querySelectorAll('.word-group'));
                    const newSection = container.querySelector('.new-section');
                    const errorSection = container.querySelector('.error-section');
                    const header = container.querySelector('.header');
                    const footer = container.querySelector('.footer');
                    
                    // 计算元素位置和高度
                    const containerRect = container.getBoundingClientRect();
                    const elements = [];
                    
                    // 添加header作为必须包含的元素
                    elements.push({
                        type: 'header',
                        element: header,
                        top: 0,
                        bottom: header.offsetHeight,
                        height: header.offsetHeight
                    });
                    
                    // 添加错误信息（如果存在）
                    if (errorSection) {
                        const rect = errorSection.getBoundingClientRect();
                        elements.push({
                            type: 'error',
                            element: errorSection,
                            top: rect.top - containerRect.top,
                            bottom: rect.bottom - containerRect.top,
                            height: rect.height
                        });
                    }
                    
                    // 按word-group分组处理news-item
                    wordGroups.forEach(group => {
                        const groupRect = group.getBoundingClientRect();
                        const groupNewsItems = group.querySelectorAll('.news-item');
                        
                        // 添加word-group的header部分
                        const wordHeader = group.querySelector('.word-header');
                        if (wordHeader) {
                            const headerRect = wordHeader.getBoundingClientRect();
                            elements.push({
                                type: 'word-header',
                                element: wordHeader,
                                parent: group,
                                top: groupRect.top - containerRect.top,
                                bottom: headerRect.bottom - containerRect.top,
                                height: headerRect.height
                            });
                        }
                        
                        // 添加每个news-item
                        groupNewsItems.forEach(item => {
                            const rect = item.getBoundingClientRect();
                            elements.push({
                                type: 'news-item',
                                element: item,
                                parent: group,
                                top: rect.top - containerRect.top,
                                bottom: rect.bottom - containerRect.top,
                                height: rect.height
                            });
                        });
                    });
                    
                    // 添加新增新闻部分
                    if (newSection) {
                        const rect = newSection.getBoundingClientRect();
                        elements.push({
                            type: 'new-section',
                            element: newSection,
                            top: rect.top - containerRect.top,
                            bottom: rect.bottom - containerRect.top,
                            height: rect.height
                        });
                    }
                    
                    // 添加footer
                    const footerRect = footer.getBoundingClientRect();
                    elements.push({
                        type: 'footer',
                        element: footer,
                        top: footerRect.top - containerRect.top,
                        bottom: footerRect.bottom - containerRect.top,
                        height: footer.offsetHeight
                    });
                    
                    // 计算分割点
                    const segments = [];
                    let currentSegment = { start: 0, end: 0, height: 0, includeHeader: true };
                    let headerHeight = header.offsetHeight;
                    currentSegment.height = headerHeight;
                    
                    for (let i = 1; i < elements.length; i++) {
                        const element = elements[i];
                        const potentialHeight = element.bottom - currentSegment.start;
                        
                        // 检查是否需要创建新分段
                        if (potentialHeight > maxHeight && currentSegment.height > headerHeight) {
                            // 在前一个元素结束处分割
                            currentSegment.end = elements[i - 1].bottom;
                            segments.push(currentSegment);
                            
                            // 开始新分段
                            currentSegment = {
                                start: currentSegment.end,
                                end: 0,
                                height: element.bottom - currentSegment.end,
                                includeHeader: false
                            };
                        } else {
                            currentSegment.height = potentialHeight;
                            currentSegment.end = element.bottom;
                        }
                    }
                    
                    // 添加最后一个分段
                    if (currentSegment.height > 0) {
                        currentSegment.end = container.offsetHeight;
                        segments.push(currentSegment);
                    }
                    
                    button.textContent = `生成中 (0/${segments.length})...`;
                    
                    // 隐藏保存按钮
                    const buttons = document.querySelector('.save-buttons');
                    buttons.style.visibility = 'hidden';
                    
                    // 为每个分段生成图片
                    const images = [];
                    for (let i = 0; i < segments.length; i++) {
                        const segment = segments[i];
                        button.textContent = `生成中 (${i + 1}/${segments.length})...`;
                        
                        // 创建临时容器用于截图
                        const tempContainer = document.createElement('div');
                        tempContainer.style.cssText = `
                            position: absolute;
                            left: -9999px;
                            top: 0;
                            width: ${container.offsetWidth}px;
                            background: white;
                        `;
                        tempContainer.className = 'container';
                        
                        // 克隆容器内容
                        const clonedContainer = container.cloneNode(true);
                        
                        // 移除克隆内容中的保存按钮
                        const clonedButtons = clonedContainer.querySelector('.save-buttons');
                        if (clonedButtons) {
                            clonedButtons.style.display = 'none';
                        }
                        
                        tempContainer.appendChild(clonedContainer);
                        document.body.appendChild(tempContainer);
                        
                        // 等待DOM更新
                        await new Promise(resolve => setTimeout(resolve, 100));
                        
                        // 使用html2canvas截取特定区域
                        const canvas = await html2canvas(clonedContainer, {
                            backgroundColor: '#ffffff',
                            scale: scale,
                            useCORS: true,
                            allowTaint: false,
                            imageTimeout: 10000,
                            logging: false,
                            width: container.offsetWidth,
                            height: segment.end - segment.start,
                            x: 0,
                            y: segment.start,
                            windowWidth: window.innerWidth,
                            windowHeight: window.innerHeight
                        });
                        
                        images.push(canvas.toDataURL('image/png', 1.0));
                        
                        // 清理临时容器
                        document.body.removeChild(tempContainer);
                    }
                    
                    // 恢复按钮显示
                    buttons.style.visibility = 'visible';
                    
                    // 下载所有图片
                    const now = new Date();
                    const baseFilename = `TrendRadar_热点新闻分析_${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}${String(now.getDate()).padStart(2, '0')}_${String(now.getHours()).padStart(2, '0')}${String(now.getMinutes()).padStart(2, '0')}`;
                    
                    for (let i = 0; i < images.length; i++) {
                        const link = document.createElement('a');
                        link.download = `${baseFilename}_part${i + 1}.png`;
                        link.href = images[i];
                        document.body.appendChild(link);
                        link.click();
                        document.body.removeChild(link);
                        
                        // 延迟一下避免浏览器阻止多个下载
                        await new Promise(resolve => setTimeout(resolve, 100));
                    }
                    
                    button.textContent = `已保存 ${segments.length} 张图片!`;
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.disabled = false;
                    }, 2000);
                    
                } catch (error) {
                    console.error('分段保存失败:', error);
                    const buttons = document.querySelector('.save-buttons');
                    buttons.style.visibility = 'visible';
                    button.textContent = '保存失败';
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.disabled = false;
                    }, 2000);
                }
            }
            
            document.addEventListener('DOMContentLoaded', function() {
                window.scrollTo(0, 0);
            });
        </script>
    </body>
    </html>
    